# Puerto del servidor
server.port=${PORT:8080}

# Logging
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.security.oauth2=TRACE
logging.level.org.springframework.web.client.RestTemplate=DEBUG
logging.level.com.diego.curso.springboot.webapp.springboot_web.config=DEBUG
logging.level.com.diego.curso.springboot.webapp.springboot_web=DEBUG

# Configuración para H2 Database (desarrollo local)
spring.datasource.url=jdbc:h2:mem:tournamentdb
spring.datasource.username=sa
spring.datasource.password=
spring.datasource.driver-class-name=org.h2.Driver

# Habilitar consola H2
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# Configuración JPA
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# ===== OAuth2 Configuration =====

# Google OAuth
spring.security.oauth2.client.registration.google.client-id=57306002614-0v1k04m5p50sgc7ksj6ahj3q2c8v5ehd.apps.googleusercontent.com
spring.security.oauth2.client.registration.google.client-secret=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
spring.security.oauth2.client.registration.google.scope=openid,profile,email
spring.security.oauth2.client.registration.google.redirect-uri={baseUrl}/login/oauth2/code/google

# ===== Keycloak OAuth Configuration =====
# SOLUCIÓN: Usar configuración manual de endpoints en lugar de issuer-uri
# Esto evita el problema de UnsatisfiedDependencyException al arranque cuando Keycloak no está disponible

# Keycloak Client Registration
spring.security.oauth2.client.registration.keycloak.client-id=tournament-system
# Client secret requerido porque "Client authentication" está ON en Keycloak
spring.security.oauth2.client.registration.keycloak.client-secret=EISy4zgMyGRjRqJXqrPe4NMHwJN7cdZ8
spring.security.oauth2.client.registration.keycloak.scope=openid,profile,email
spring.security.oauth2.client.registration.keycloak.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.keycloak.redirect-uri={baseUrl}/login/oauth2/code/keycloak
spring.security.oauth2.client.registration.keycloak.client-name=Keycloak
spring.security.oauth2.client.registration.keycloak.client-authentication-method=client_secret_post

# Keycloak Provider - Configuración manual de endpoints (recomendado para Spring Boot 3.x)
# Esta configuración NO requiere que Keycloak esté disponible durante el arranque de la aplicación
spring.security.oauth2.client.provider.keycloak.authorization-uri=http://localhost:8090/realms/tournament/protocol/openid-connect/auth
spring.security.oauth2.client.provider.keycloak.token-uri=http://localhost:8090/realms/tournament/protocol/openid-connect/token
spring.security.oauth2.client.provider.keycloak.user-info-uri=http://localhost:8090/realms/tournament/protocol/openid-connect/userinfo
spring.security.oauth2.client.provider.keycloak.jwk-set-uri=http://localhost:8090/realms/tournament/protocol/openid-connect/certs
spring.security.oauth2.client.provider.keycloak.user-name-attribute=preferred_username

# Alternativa: Si prefieres usar issuer-uri (requiere que Keycloak esté disponible al arranque)
# Descomentar la siguiente línea y comentar las 5 líneas de configuración manual arriba:
# spring.security.oauth2.client.provider.keycloak.issuer-uri=http://localhost:8090/realms/tournament

# Identity Server
identity.server.url=http://localhost:5111


